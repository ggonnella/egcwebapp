{% block content %}
  {% set table_id="unit-table" %}
  {% if main %}
  {% set show_refby=True %}
  {% else %}
  {% set table_id=table_id+"-"+parent_id%}
  {% endif %}
  <div id="{{table_id}}-wrapper">
    <table id="{{table_id}}" class="table table-striped table-hover">
      <thead>
        <tr>
            <th>ID</th>
            <th>Type</th>
            <th>Definition</th>
            <th>Symbol</th>
            <th>Description</th>
            <th>Tags</th>
            {% if show_refby %}
              <th>Referenced&nbsp;by</th>
            {% endif %}
            <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for unit in units %}
          <tr>
            <td>{{ unit.id }}</td>
            <td>{{ unit.type }}</td>
            <td>{{ unit.definition }}</td>
            <td>{{ unit.symbol }}</td>
            <td>{{ unit.description }}</td>
            <td>
              {% set tags = unit.tags %}
              {% include 'tags_lines.html' %}
            </td>
            {% if show_refby %}
              <td>
                {% set ref_by_type, ref_id, ref_rt, ref_by_rt =
                       'attribute', unit.id, 'U', 'A' %}
                {% include 'ref_by_link.html' %}
                {% set ref_by_type, ref_id, ref_rt, ref_by_rt =
                       'unit', unit.id, 'U', 'U' %}
                {% include 'ref_by_link.html' %}
              </td>
            {% endif %}
            <td>
              <a href="{{ url_for('edit_unit', record_id=unit.id) }}">
                <i class="fas fa-edit"></i></a>
              <form action="{{ url_for('delete_unit', record_id=unit.id) }}"
                method="post" style="display: inline-block;">
              <input type="hidden" name="_method" vaue="DELETE">
              <button type="submit" class="btn btn-link">
                <i class="fas fa-trash"></i></button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% if show_refby %}
    <script type="module">
     import { openNestedTable } from
          '{{ url_for('static', filename='js/nested_table.js') }}';
      $(function() {
        $('body').on('click', '.show-attributes',
              openNestedTable('units', 'attributes', 8));
      });
      $(function() {
        $('body').on('click', '.show-units',
              openNestedTable('units', 'units', 8));
      });
    </script>
  {% endif %}
  {% if not main %}
    <script type="module">
      import { initNestedTable } from
          '{{ url_for('static', filename='js/nested_table.js') }}';
      $(document).ready(function() { initNestedTable("{{table_id}}"); });
    </script>
  {% endif %}
{% endblock %}
