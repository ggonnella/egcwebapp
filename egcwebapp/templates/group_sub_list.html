{% block content %}

<div id="group-sub-table-wrapper-{{parent_id}}">
  <table id="group-sub-table-{{parent_id}}" class="table table-striped table-hover">
    <thead>
      <tr>
          <th>ID</th>
          <th>Type</th>
          <th>Name</th>
          <th>Definition</th>
          <th>Tags</th>
          <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for group in groups %}
        <tr>
          <td>{{ group.id }}</td>
          <td>{{ group.type }}</td>
          <td>{{ group.name }}</td>
          <td>{{ group.definition }}</td>
          <td>{{ group.tags }}</td>
          <td>
            <a href="{{ url_for('edit_group', record_id=group.id) }}"><i class="fas fa-edit"></i></a>
            <form action="{{ url_for('delete_grou', record_id=group.id) }}" method="post" style="display: inline-block;">
              <input type="hidden" name="_method" value="DELETE">
              <button type="submit" class="btn btn-link"><i class="fas fa-trash"></i></button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<script>
  $(document).ready(function() {
      var table = $("#group-sub-table-{{parent_id}}").DataTable();
      // Create the close button with the FontAwesome icon
      var closeButton = $('<button id="close-nested-table" class="btn btn-sm btn-light" style="margin-left: 10px;"><i class="fas fa-times"></i></button>');

      // Attach the click event to the close button
      closeButton.on('click', closeNestedTable);

      // Insert the close button as a sibling element of the search input
      $("#group-sub-table-wrapper-{{parent_id}} .dataTables_filter").append(closeButton);
      return table;
  });

  // Function to remove the nested table when the close button is clicked
  function closeNestedTable() {
    var $nestedGroups = $(this).closest('div.dataTables_wrapper').parent().parent().parent();
    if ($nestedGroups.length > 0) {
      $nestedGroups.remove();
    }
  }
</script>

{% endblock %}
p
